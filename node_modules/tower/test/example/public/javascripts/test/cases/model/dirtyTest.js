var model;

model = null;

describe('Tower.Model.Dirty', function() {
  beforeEach(function() {
    return model = new App.BaseModel;
  });
  test('#changes', function() {
    assert.isObject(model.changes);
    model.set('likeCountWithDefault', 10);
    return assert.deepEqual(model.changes, {
      before: {
        likeCountWithDefault: 0
      },
      after: {
        $set: {
          likeCountWithDefault: 10
        }
      },
      likeCountWithDefault: [0, 10]
    });
  });
  test('#attributeWas', function() {
    assert.equal(model.attributeWas("likeCountWithDefault"), void 0);
    model.set('likeCountWithDefault', 10);
    return assert.equal(model.attributeWas("likeCountWithDefault"), 0);
  });
  test('#attributeChanged', function() {
    assert.equal(model.attributeChanged("likeCountWithDefault"), false);
    model.set('likeCountWithDefault', 10);
    return assert.equal(model.attributeChanged("likeCountWithDefault"), true);
  });
  return test('$set', function() {
    model.set({
      title: "A Title!",
      $push: {
        tags: "javascript"
      },
      $inc: {
        likeCount: 2
      }
    });
    assert.equal(model.get("title"), "A Title!");
    assert.equal(model.get("likeCount"), 2);
    assert.deepEqual(model.get("tags"), ["javascript"]);
    assert.deepEqual(model.changes, {
      before: {
        title: null,
        tags: [],
        likeCount: 0
      },
      after: {
        $set: {
          title: 'A Title!'
        },
        $push: {
          tags: ["javascript"]
        },
        $inc: {
          likeCount: 2
        }
      },
      title: [void 0, 'A Title!']
    });
    model.set({
      $set: {
        title: "Another Title!"
      },
      $push: {
        tags: "javascript"
      },
      $inc: {
        likeCount: 2
      }
    });
    assert.equal(model.get("title"), "Another Title!");
    assert.equal(model.get("likeCount"), 4);
    assert.deepEqual(model.get("tags"), ["javascript", "javascript"]);
    return assert.deepEqual(model.changes, {
      before: {
        title: null,
        tags: [],
        likeCount: 0
      },
      after: {
        $set: {
          title: 'Another Title!'
        },
        $push: {
          tags: ["javascript", "javascript"]
        },
        $inc: {
          likeCount: 4
        }
      },
      title: ['A Title!', 'Another Title!']
    });
  });
});
