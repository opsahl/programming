var describeWith;

describeWith = function(store) {
  return describe("Issue105", function() {
    var post;
    post = null;
    beforeEach(function(done) {
      return Tower.start(function() {
        App.BaseModel.store(store);
        App.Post.store(store);
        post = new App.Post({
          rating: 4
        });
        return post.save(done);
      });
    });
    afterEach(function() {
      return Tower.stop();
    });
    test('user created', function(done) {
      return App.Post.find(post.get("id"), function(err, resource) {
        assert.ok(resource.get("id"));
        assert.equal(post.get("id").toString(), resource.get("id").toString());
        return done();
      });
    });
    return test('handle request with unknown format', function(done) {
      var options;
      options = {
        format: "form"
      };
      return _.destroy("/posts/" + post.get("id"), options, function(response) {
        return App.Post.find(post.get("id"), function(err, resource) {
          assert.equal(resource, void 0);
          return done();
        });
      });
    });
  });
};

if (!Tower.client) {
  describeWith(Tower.Store.MongoDB);
}
